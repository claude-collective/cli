# Release 0.45.0 (2026-02-22)

## Added

- **Persist selectedAgents in config** — Edit mode now restores the user's agent selection from config instead of re-running domain-based preselection. New `selectedAgents` field on `ProjectConfig`, schema, and local-installer.
- **Validate skill relation refs in health check** — `checkSkillRelationRefs` verifies that all cross-skill references (`compatibleWith`, `conflictsWith`, `requires`, `requiresSetup`, `providesSetupFor`) resolve to existing skills. Catches dangling references at load time.
- **Custom extensibility design doc** — Comprehensive design for allowing private marketplace users to create custom skills, agents, categories, and domains.
- **Install mode redesign design doc** — UX redesign spec with ASCII mockups for replacing the hidden `P` hotkey toggle with explicit install mode choice.

## Fixed

- **Eject preserves existing templates** — `eject agent-partials` now skips templates that already exist and warns, instead of blocking entirely or overwriting with `--force`.
- **Clean cache dir before --refresh** — Removes entire cache directory before fetching when `forceRefresh` is set, preventing orphan skills from renamed/deleted sources.

## Changed

- **TEST_SKILLS constants replace createMockSkill** — 26 inline `createMockSkill()` calls replaced with shared `TEST_SKILLS` constants. Fixed incorrect categories in multi-source-loader tests. Source-loader tests now use `createTestSource()` fixtures instead of depending on the real skills repo.
- **Real skill IDs in tests** — Fake test IDs (`web-test-react`, `web-scss-mod`) replaced with real ones from the type system. Unnecessary `as`-casts on `Subcategory`, `Domain`, and `CategoryMap` removed.
- **D-43 task added** — Remove `getAgentsForSkill` / `skillToAgents` / `agentSkillPrefixes` (prerequisite for D-37 and custom extensibility).
- **CLAUDE.md rules** — Added worktree prohibition and workflow pattern restriction rules.
