# Release 0.51.0 (2026-02-28)

## Added

- **`installScope` in wizard store** — Track project vs global install scope in wizard state. Adds `toggleInstallScope` action, UI indicator in wizard layout, and display in step-confirm. Init command uses wizard result instead of raw `--global` flag.
- **Global test isolation (`vitest.setup.ts`)** — New setup file mocks `os.homedir()` to an isolated temp dir, preventing the real `~/.claude-src/config.yaml` from polluting test results via `loadProjectConfig()` global fallback.

## Fixed

- **Test failures from global config leaking** — 16 test files (63 tests) were failing because `loadProjectConfig()` fell back to the user's real global config. The global `os.homedir()` mock in `vitest.setup.ts` fixes all of them.
- **`normalizeStackRecord` mock missing** — `local-installer.test.ts` mock of `stacks-loader` now uses `importOriginal` to preserve real exports alongside mocked `loadStackById`.
- **`plugin-settings.test.ts` registry path** — Changed static `registryPath` const to lazy `getRegistryPath()` function so it picks up the mocked `os.homedir()` at test time.
