# Release 0.46.0 (2026-02-24)

## Added

- **Custom extensibility foundation (D-46)** — Private marketplaces can now define custom skills, agents, categories, and domains that the CLI discovers and validates at runtime.
  - Runtime-extensible Zod schemas (`extendSchemasWithCustomValues()`) accept custom categories, domains, agent names, and skill IDs
  - `discoverAndExtendFromSource()` pre-scans source agents/skills for `custom: true` entities before full load
  - CLI and source matrices are merged (categories, relationships, aliases) instead of using one or the other
  - `custom?: boolean` field added to `AgentYamlConfig`, `CategoryDefinition`, `ExtractedSkillMetadata`, and `SkillMetadataConfig`
- **Dynamic wizard domains and agents** — Domain selection and agent steps derive available options from the merged matrix instead of hardcoded arrays, supporting custom domains and agents from private marketplaces.
- **`eject templates` command (D-43)** — Templates promoted to first-class eject type (`agentsinc eject templates`) replacing the `--templates` flag on `agent-partials`.
- **`new marketplace` command** — Scaffold a new private marketplace with stacks, skills, and marketplace.json. Delegates skill creation to `new:skill` for single-source scaffolding logic.
- **`new skill --output` flag** — Override skill output directory. Auto-detects marketplace context and creates skills in `skills/` instead of `.claude-src/skills/`.

## Fixed

- **`new agent` Enter key** — Fix PurposeInput Ink component hanging on Enter by adding `useApp()` exit() calls.
- **`new agent` loading** — Simplify agent-summoner loading to read a single compiled `.md` file with gray-matter instead of multiple partial files. Local-first with remote fallback.
- **Plugin mode marketplace registration** — Strip `github:` prefix from source URL before passing to Claude CLI's `claudePluginMarketplaceAdd()`.
- **Stack domain preselection** — Selecting a stack now correctly pre-selects only the stack's domains instead of all domains.

## Changed

- **Remove agent-mappings.yaml and skill-to-agent routing (D-43)** — Delete `agent-mappings.yaml`, `defaults-loader.ts`, and `getAgentsForSkill`/`getEffectiveSkillToAgents`/`DEFAULT_AGENTS`. All selected skills are now assigned to all selected agents; stacks remain the mechanism for fine-grained mapping.
- **Remove legacy slash-in-ID resolution** — Delete `buildAliasTargetToSkillIdMap` from matrix-loader (dead code path for old ID formats).
- **Skill scaffold defaults** — `new skill` no longer adds author to SKILL.md name field; metadata uses `custom: true` instead of `$schema` comment; default category is `dummy-category`, author is `@dummy-author`.
- **KEBAB_CASE_PATTERN** — Extracted to `consts.ts` as shared constant (was duplicated in `skill.ts` and `schemas.ts`).
- **`getDomainDisplayName`** — Accepts any string and falls back to title-case for custom domains.
- **`ResolvedStack.skills`** — Changed from `Partial<Record<AgentName, Partial<Record<Subcategory, SkillId>>>>` to `Record<AgentName, Partial<Record<Subcategory, SkillId[]>>>` for multi-skill-per-category support.
- **Remove `audience` from `SuggestedStack`/`ResolvedStack`** — Unused field removed.
