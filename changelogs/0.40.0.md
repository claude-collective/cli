# Release 0.40.0 (2026-02-19)

## Breaking Changes

- All subcategory keys are now domain-prefixed (e.g., `framework` → `web-framework`, `testing` → `web-testing`, `methodology` → `shared-methodology`)
- Consumer `config.yaml` files with bare subcategory keys must re-run the wizard
- `CategoryPath` no longer accepts slash-separated paths (`web/framework`) — only hyphen-separated (`web-framework`)
- `metadata.schema.json` `category` field now validates against a strict enum of domain-prefixed subcategories

## Changed

- **D-31: Prefix all subcategories with domain** — 38 subcategory values renamed from bare names to `domain-subcategory` format across types, schemas, YAML configs, and all source code
- **D-32: Category enum in metadata schema** — `category` field in `metadataValidationSchema` changed from `z.string()` to `subcategorySchema`, enforcing valid subcategory values at parse time
- `extractSubcategoryFromPath()` simplified — no longer splits on `/`, returns CategoryPath directly as Subcategory
- `FRAMEWORK_SUBCATEGORY_ID` and `FRAMEWORK_CATEGORY_ID` constants updated to `"web-framework"`
- `stackSubcategorySchema` simplified — `SUBCATEGORY_VALUES` already includes stacks-only keys, removing redundant extension
- `categoryPathSchema` regex updated to include `shared` domain prefix

## Renamed (D-31 mapping)

### Web domain
`framework` → `web-framework`, `styling` → `web-styling`, `client-state` → `web-client-state`, `server-state` → `web-server-state`, `forms` → `web-forms`, `testing` → `web-testing`, `ui-components` → `web-ui-components`, `mocking` → `web-mocking`, `error-handling` → `web-error-handling`, `i18n` → `web-i18n`, `file-upload` → `web-file-upload`, `files` → `web-files`, `utilities` → `web-utilities`, `realtime` → `web-realtime`, `animation` → `web-animation`, `pwa` → `web-pwa`, `accessibility` → `web-accessibility`

### API domain
`api` → `api-api`, `database` → `api-database`, `auth` → `api-auth`, `observability` → `api-observability`, `analytics` → `api-analytics`, `email` → `api-email`, `performance` → `api-performance`

### Shared domain
`monorepo` → `shared-monorepo`, `tooling` → `shared-tooling`, `security` → `shared-security`, `methodology` → `shared-methodology`, `research` → `shared-research`, `reviewing` → `shared-reviewing`, `ci-cd` → `shared-ci-cd`

### Stacks-only
`base-framework` → `web-base-framework`, `platform` → `mobile-platform`

### No change (already prefixed)
`web-performance`, `mobile-framework`, `cli-framework`, `cli-prompts`, `cli-testing`

## Files Changed

### Types & Schemas
- `src/cli/types/matrix.ts` — `Subcategory` union (38 domain-prefixed values)
- `src/cli/types/skills.ts` — `CategoryPath` type (removed slash branch), stale comment fix
- `src/cli/lib/schemas.ts` — `SUBCATEGORY_VALUES`, `stackSubcategorySchema`, `categoryPathSchema`, `metadataValidationSchema`
- `src/schemas/skills-matrix.schema.json` — 3 enum arrays updated
- `src/schemas/stacks.schema.json` — subcategory enum updated
- `src/schemas/project-config.schema.json` — subcategory enum updated
- `src/schemas/metadata.schema.json` — category enum added (D-32)
- 6 other JSON schemas regenerated

### YAML Configs
- `config/skills-matrix.yaml` — 36 category keys + id fields renamed
- `config/stacks.yaml` — ~686 subcategory key renames

### Source Code
- `src/cli/lib/configuration/config-generator.ts` — simplified `extractSubcategoryFromPath`
- `src/cli/lib/wizard/build-step-logic.ts` — `FRAMEWORK_SUBCATEGORY_ID` constant
- `src/cli/components/hooks/use-category-grid-input.ts` — `FRAMEWORK_CATEGORY_ID` constant
- `src/cli/lib/skills/local-skill-loader.ts` — stale comment fix
- `src/cli/lib/installation/local-installer.ts` — category path references
- `src/cli/lib/permission-checker.tsx` — category path references

### Tests (30+ files)
All test files updated with domain-prefixed subcategory values, slash-to-hyphen conversions, and fixture updates.

### Documentation
- `todo/TODO.md` — D-31 and D-32 removed (completed)
- `todo/TODO-completed.md` — D-31 and D-32 added
- `todo/TODO-deferred.md` — D-38 added (remove web-base-framework)
- `todo/D-38-remove-base-framework.md` — implementation plan created
